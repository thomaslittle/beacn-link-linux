<ControlTemplate xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 mc:Ignorable="d" 
                 TargetType="CheckBox">
  <Grid>
    <VisualStateManager.VisualStateGroups>
      <VisualStateGroup x:Name="CombinedStates">
        <VisualState x:Name="UncheckedNormal">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundUnchecked}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage2, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset2" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage1, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="OverlayRectangle" Storyboard.TargetProperty="Opacity" From="0" To="1" />
          </Storyboard>
        </VisualState>
        <VisualState x:Name="UncheckedPointerOver">
          <Storyboard>
             <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
               <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundUncheckedPointerOver}" />
             </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage1, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset2" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage2, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="OverlayRectangle" Storyboard.TargetProperty="Opacity" From="0" To="1"/>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="UncheckedPressed">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundUncheckedPressed}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage3, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="UncheckedDisabled">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundUncheckedDisabled}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage4, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="CheckedNormal">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundChecked}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage6, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset2" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage5, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="OverlayRectangle" Storyboard.TargetProperty="Opacity" From="0" To="1"/>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="CheckedPointerOver">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundCheckedPointerOver}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage5, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset2" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage6, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="OverlayRectangle" Storyboard.TargetProperty="Opacity" From="0" To="1"/>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="CheckedPressed">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundCheckedPressed}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage7, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="CheckedDisabled">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundCheckedDisabled}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage8, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="IndeterminateNormal">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundIndeterminate}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage10, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset2" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage9, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="OverlayRectangle" Storyboard.TargetProperty="Opacity" From="0" To="1"/>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="IndeterminatePointerOver">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundIndeterminatePointerOver}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage9, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset2" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage10, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
            <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="OverlayRectangle" Storyboard.TargetProperty="Opacity" From="0" To="1"/>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="IndeterminatePressed">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundIndeterminatePressed}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage11, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="IndeterminateDisabled">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CheckBoxForegroundIndeterminateDisabled}" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SpriteSheetOffset" Storyboard.TargetProperty="X">
              <DiscreteObjectKeyFrame KeyTime="0" Value="{Binding Path=StateImage12, RelativeSource={RelativeSource TemplatedParent}}"/>
            </ObjectAnimationUsingKeyFrames>
          </Storyboard>
        </VisualState>
      </VisualStateGroup>
    </VisualStateManager.VisualStateGroups>
    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="auto"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
      <Canvas Width="{Binding Path=StateImageWidth, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=StateImageHeight, RelativeSource={RelativeSource TemplatedParent}}">
        <Rectangle Width="{Binding Path=StateImageWidth, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=StateImageHeight, RelativeSource={RelativeSource TemplatedParent}}" Opacity="1.0">
          <Rectangle.Fill>
            <ImageBrush x:Name="Image0" AlignmentX="Left"
                    AlignmentY="Top"
                    ImageSource="{Binding Path=ImagePath, RelativeSource={RelativeSource TemplatedParent}}"
                    Stretch="None">
              <ImageBrush.RelativeTransform>
                <ScaleTransform  ScaleX="1" ScaleY="1"/>
              </ImageBrush.RelativeTransform>
              <ImageBrush.Transform>
                <TranslateTransform x:Name="SpriteSheetOffset" X="0" Y="0" />
              </ImageBrush.Transform>
            </ImageBrush>
          </Rectangle.Fill>
        </Rectangle>
        <Rectangle x:Name="OverlayRectangle" Width="{Binding Path=StateImageWidth, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=StateImageHeight, RelativeSource={RelativeSource TemplatedParent}}" Canvas.ZIndex="1" Opacity="0.0">
          <Rectangle.Fill>
            <ImageBrush x:Name="Image0" AlignmentX="Left"
                    AlignmentY="Top"
                    ImageSource="{Binding Path=ImagePath, RelativeSource={RelativeSource TemplatedParent}}"
                    Stretch="None">
              <ImageBrush.RelativeTransform>
                <ScaleTransform  ScaleX="1" ScaleY="1"/>
              </ImageBrush.RelativeTransform>
              <ImageBrush.Transform>
                <TranslateTransform x:Name="SpriteSheetOffset2" X="0" Y="0" />
              </ImageBrush.Transform>
            </ImageBrush>
          </Rectangle.Fill>
        </Rectangle>
      </Canvas>
      <ContentPresenter x:Name="ContentPresenter" AutomationProperties.AccessibilityView="Raw" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" ContentTransitions="{TemplateBinding ContentTransitions}" Grid.Column="1" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" TextWrapping="Wrap" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
    </Grid>
  </Grid>
</ControlTemplate>