<ControlTemplate xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d" TargetType="Button">
  <Grid>
    <VisualStateManager.VisualStateGroups>
      <VisualStateGroup x:Name="CommonStates">
        <VisualState x:Name="Normal" >
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="X" Storyboard.TargetName="SpriteSheetOffset">
              <DiscreteObjectKeyFrame KeyTime="0" Value="-<xhover>" />
            </ObjectAnimationUsingKeyFrames>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="X" Storyboard.TargetName="SpriteSheetOffset2">
              <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
            </ObjectAnimationUsingKeyFrames>
            <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="OverlayRectangle" Storyboard.TargetProperty="Opacity" From="0" To="1"/>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="PointerOver">
          <Storyboard>
            <Storyboard>
              <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="X" Storyboard.TargetName="SpriteSheetOffset">
                <DiscreteObjectKeyFrame KeyTime="0" Value="0" />
              </ObjectAnimationUsingKeyFrames>
              <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="X" Storyboard.TargetName="SpriteSheetOffset2">
                <DiscreteObjectKeyFrame KeyTime="0" Value="-<xhover>" />
              </ObjectAnimationUsingKeyFrames>
              <DoubleAnimation Duration="0:0:0.5" Storyboard.TargetName="OverlayRectangle" Storyboard.TargetProperty="Opacity" From="0" To="1"/>
            </Storyboard>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="Pressed">
          <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="X" Storyboard.TargetName="SpriteSheetOffset">
              <DiscreteObjectKeyFrame KeyTime="0" Value="-<xpressed>" />
            </ObjectAnimationUsingKeyFrames>
          </Storyboard>
        </VisualState>
        <VisualState x:Name="Disabled">
          <Storyboard>
            <Storyboard>
              <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="X" Storyboard.TargetName="SpriteSheetOffset">
                <DiscreteObjectKeyFrame KeyTime="0" Value="-<xdisabled>" />
              </ObjectAnimationUsingKeyFrames>
            </Storyboard>
          </Storyboard>
        </VisualState>
      </VisualStateGroup>
      <VisualStateGroup x:Name="FocusStates">
        <VisualState x:Name="Focused" />
        <VisualState x:Name="Unfocused" />
        <VisualState x:Name="PointerFocused" />
      </VisualStateGroup>
    </VisualStateManager.VisualStateGroups>
    <Canvas>
      <Rectangle Width="{TemplateBinding Width}" Height="{TemplateBinding Height}">
        <Rectangle.Fill>
          <ImageBrush AlignmentX="Left" AlignmentY="Top" ImageSource="<spritesource>" Stretch="None">
            <ImageBrush.RelativeTransform>
              <ScaleTransform  ScaleX="<scalex>" ScaleY="<scaley>"/>
            </ImageBrush.RelativeTransform>
            <ImageBrush.Transform>
              <TranslateTransform x:Name="SpriteSheetOffset" X="0" Y="0" />
            </ImageBrush.Transform>
          </ImageBrush>
        </Rectangle.Fill>
      </Rectangle>
      <Rectangle x:Name="OverlayRectangle" Width="{TemplateBinding Width}" Height="{TemplateBinding Height}" Canvas.ZIndex="1" Opacity="0.0">
        <Rectangle.Fill>
          <ImageBrush AlignmentX="Left" AlignmentY="Top" ImageSource="<spritesource>" Stretch="None">
            <ImageBrush.RelativeTransform>
              <ScaleTransform  ScaleX="<scalex>" ScaleY="<scaley>"/>
            </ImageBrush.RelativeTransform>
            <ImageBrush.Transform>
              <TranslateTransform x:Name="SpriteSheetOffset2" X="0" Y="0" />
            </ImageBrush.Transform>
          </ImageBrush>
        </Rectangle.Fill>
      </Rectangle>
    </Canvas>
    <ContentPresenter BorderThickness="{TemplateBinding BorderThickness}" 
                          BorderBrush="{TemplateBinding BorderBrush}" 
                          Content="{TemplateBinding Content}" 
                          CornerRadius="{TemplateBinding CornerRadius}" 
                          Padding="{TemplateBinding Padding}" 
                          VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                          HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                          Canvas.ZIndex="2"/>
  </Grid>
</ControlTemplate>